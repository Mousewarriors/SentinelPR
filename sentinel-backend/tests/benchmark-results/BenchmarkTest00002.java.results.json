{
  "meta": {
    "repo": "BenchmarkingJava",
    "relPath": "src/main/java/org/owasp/benchmark/testcode/BenchmarkTest00002.java",
    "lang": "java"
  },
  "verdict": "WARN",
  "findingCount": 11,
  "findings": [
    {
      "ruleId": "A201_WEAK_SESSION_COOKIE",
      "kind": "WARN",
      "severity": "HIGH",
      "status": "NEW",
      "title": "Session cookie may be missing security attributes",
      "description": "Session cookies may be missing secure attributes.",
      "risk": "Cookies without proper flags are more vulnerable to theft or misuse.",
      "confidenceRationale": "Cookie-related code was modified, but the analysis cannot confirm runtime behavior or environment defaults.",
      "recommendation": "Ensure secure, httpOnly, and appropriate sameSite attributes are set for session cookies.",
      "file": "BenchmarkTest00002.java",
      "line": 38,
      "snippet": "userCookie.setMaxAge(60 * 3); // Store cookie for 3 minutes"
    },
    {
      "ruleId": "A201_WEAK_SESSION_COOKIE",
      "kind": "WARN",
      "severity": "HIGH",
      "status": "NEW",
      "title": "Session cookie may be missing security attributes",
      "description": "Session cookies may be missing secure attributes.",
      "risk": "Cookies without proper flags are more vulnerable to theft or misuse.",
      "confidenceRationale": "Cookie-related code was modified, but the analysis cannot confirm runtime behavior or environment defaults.",
      "recommendation": "Ensure secure, httpOnly, and appropriate sameSite attributes are set for session cookies.",
      "file": "BenchmarkTest00002.java",
      "line": 39,
      "snippet": "userCookie.setSecure(true);"
    },
    {
      "ruleId": "A201_WEAK_SESSION_COOKIE",
      "kind": "WARN",
      "severity": "HIGH",
      "status": "NEW",
      "title": "Session cookie may be missing security attributes",
      "description": "Session cookies may be missing secure attributes.",
      "risk": "Cookies without proper flags are more vulnerable to theft or misuse.",
      "confidenceRationale": "Cookie-related code was modified, but the analysis cannot confirm runtime behavior or environment defaults.",
      "recommendation": "Ensure secure, httpOnly, and appropriate sameSite attributes are set for session cookies.",
      "file": "BenchmarkTest00002.java",
      "line": 40,
      "snippet": "userCookie.setHttpOnly(true);"
    },
    {
      "ruleId": "A201_WEAK_SESSION_COOKIE",
      "kind": "WARN",
      "severity": "HIGH",
      "status": "NEW",
      "title": "Session cookie may be missing security attributes",
      "description": "Session cookies may be missing secure attributes.",
      "risk": "Cookies without proper flags are more vulnerable to theft or misuse.",
      "confidenceRationale": "Cookie-related code was modified, but the analysis cannot confirm runtime behavior or environment defaults.",
      "recommendation": "Ensure secure, httpOnly, and appropriate sameSite attributes are set for session cookies.",
      "file": "BenchmarkTest00002.java",
      "line": 41,
      "snippet": "userCookie.setPath(request.getRequestURI());"
    },
    {
      "ruleId": "A201_WEAK_SESSION_COOKIE",
      "kind": "WARN",
      "severity": "HIGH",
      "status": "NEW",
      "title": "Session cookie may be missing security attributes",
      "description": "Session cookies may be missing secure attributes.",
      "risk": "Cookies without proper flags are more vulnerable to theft or misuse.",
      "confidenceRationale": "Cookie-related code was modified, but the analysis cannot confirm runtime behavior or environment defaults.",
      "recommendation": "Ensure secure, httpOnly, and appropriate sameSite attributes are set for session cookies.",
      "file": "BenchmarkTest00002.java",
      "line": 42,
      "snippet": "userCookie.setDomain(new java.net.URL(request.getRequestURL().toString()).getHost());"
    },
    {
      "ruleId": "F913_FILENAME_NOT_SANITIZED",
      "kind": "WARN",
      "severity": "MEDIUM",
      "status": "NEW",
      "title": "Filename used without obvious sanitization",
      "description": "Upload filename appears used without obvious normalization/sanitization nearby.",
      "risk": "Unsanitized filenames can include traversal sequences, unicode tricks, or dangerous extensions.",
      "confidenceRationale": "Heuristic: sanitization may exist in shared helpers; still worth review.",
      "recommendation": "Normalize filenames, strip path separators, enforce allowlisted extensions, and generate server-side storage names.",
      "file": "BenchmarkTest00002.java",
      "line": 37,
      "snippet": "new javax.servlet.http.Cookie(\"BenchmarkTest00002\", \"FileName\");"
    },
    {
      "ruleId": "F913_FILENAME_NOT_SANITIZED",
      "kind": "WARN",
      "severity": "MEDIUM",
      "status": "NEW",
      "title": "Filename used without obvious sanitization",
      "description": "Upload filename appears used without obvious normalization/sanitization nearby.",
      "risk": "Unsanitized filenames can include traversal sequences, unicode tricks, or dangerous extensions.",
      "confidenceRationale": "Heuristic: sanitization may exist in shared helpers; still worth review.",
      "recommendation": "Normalize filenames, strip path separators, enforce allowlisted extensions, and generate server-side storage names.",
      "file": "BenchmarkTest00002.java",
      "line": 67,
      "snippet": "String fileName = null;"
    },
    {
      "ruleId": "F913_FILENAME_NOT_SANITIZED",
      "kind": "WARN",
      "severity": "MEDIUM",
      "status": "NEW",
      "title": "Filename used without obvious sanitization",
      "description": "Upload filename appears used without obvious normalization/sanitization nearby.",
      "risk": "Unsanitized filenames can include traversal sequences, unicode tricks, or dangerous extensions.",
      "confidenceRationale": "Heuristic: sanitization may exist in shared helpers; still worth review.",
      "recommendation": "Normalize filenames, strip path separators, enforce allowlisted extensions, and generate server-side storage names.",
      "file": "BenchmarkTest00002.java",
      "line": 71,
      "snippet": "fileName = org.owasp.benchmark.helpers.Utils.TESTFILES_DIR + param;"
    },
    {
      "ruleId": "F913_FILENAME_NOT_SANITIZED",
      "kind": "WARN",
      "severity": "MEDIUM",
      "status": "NEW",
      "title": "Filename used without obvious sanitization",
      "description": "Upload filename appears used without obvious normalization/sanitization nearby.",
      "risk": "Unsanitized filenames can include traversal sequences, unicode tricks, or dangerous extensions.",
      "confidenceRationale": "Heuristic: sanitization may exist in shared helpers; still worth review.",
      "recommendation": "Normalize filenames, strip path separators, enforce allowlisted extensions, and generate server-side storage names.",
      "file": "BenchmarkTest00002.java",
      "line": 73,
      "snippet": "fos = new java.io.FileOutputStream(fileName, false);"
    },
    {
      "ruleId": "F913_FILENAME_NOT_SANITIZED",
      "kind": "WARN",
      "severity": "MEDIUM",
      "status": "NEW",
      "title": "Filename used without obvious sanitization",
      "description": "Upload filename appears used without obvious normalization/sanitization nearby.",
      "risk": "Unsanitized filenames can include traversal sequences, unicode tricks, or dangerous extensions.",
      "confidenceRationale": "Heuristic: sanitization may exist in shared helpers; still worth review.",
      "recommendation": "Normalize filenames, strip path separators, enforce allowlisted extensions, and generate server-side storage names.",
      "file": "BenchmarkTest00002.java",
      "line": 77,
      "snippet": "+ org.owasp.esapi.ESAPI.encoder().encodeForHTML(fileName));"
    },
    {
      "ruleId": "F913_FILENAME_NOT_SANITIZED",
      "kind": "WARN",
      "severity": "MEDIUM",
      "status": "NEW",
      "title": "Filename used without obvious sanitization",
      "description": "Upload filename appears used without obvious normalization/sanitization nearby.",
      "risk": "Unsanitized filenames can include traversal sequences, unicode tricks, or dangerous extensions.",
      "confidenceRationale": "Heuristic: sanitization may exist in shared helpers; still worth review.",
      "recommendation": "Normalize filenames, strip path separators, enforce allowlisted extensions, and generate server-side storage names.",
      "file": "BenchmarkTest00002.java",
      "line": 80,
      "snippet": "System.out.println(\"Couldn't open FileOutputStream on file: '\" + fileName + \"'\");"
    }
  ]
}