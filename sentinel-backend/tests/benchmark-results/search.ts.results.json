{
  "meta": {
    "repo": "juice-shop",
    "relPath": "routes/search.ts",
    "lang": "typescript"
  },
  "verdict": "FAIL",
  "findingCount": 15,
  "findings": [
    {
      "ruleId": "SQL001_TEMPLATE_TO_QUERY",
      "kind": "FAIL",
      "severity": "CRITICAL",
      "status": "NEW",
      "title": "SQL query built with string interpolation or concatenation",
      "description": "A SQL query string is constructed via template interpolation, string concatenation, or format strings, then passed into a query execution API.",
      "risk": "Interpolating or concatenating user input into SQL enables SQL injection, allowing attackers to read, modify, or delete database data.",
      "confidenceRationale": "Interpolation or concatenation inside a direct query execution call is a deterministic indicator of unsafe query construction.",
      "recommendation": "Use parameterized queries or prepared statements in every language: ? placeholders (Go/Java/PHP), @param (C#), bind parameters (Rails ActiveRecord).",
      "file": "search.ts",
      "line": 23,
      "snippet": "models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`) // vuln-code-snippet vuln-line unionSqlInjectionChallenge dbSchemaChallenge"
    },
    {
      "ruleId": "I302_SQL_TEMPLATE_LITERAL",
      "kind": "WARN",
      "severity": "HIGH",
      "status": "NEW",
      "title": "Possible SQL injection risk (template literal)",
      "description": "SQL appears to be constructed using a template literal with interpolation.",
      "risk": "If untrusted input is interpolated, this may enable SQL injection.",
      "confidenceRationale": "Interpolation is detectable, but context (trusted vs untrusted input) cannot be proven from diff-only scanning.",
      "recommendation": "Use parameterized queries or library-supported placeholders instead of interpolating variables into SQL.",
      "file": "search.ts",
      "line": 23,
      "snippet": "models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`) // vuln-code-snippet vuln-line unionSqlInjectionChallenge dbSchemaChallenge"
    },
    {
      "ruleId": "F910_ZIP_SLIP_PATTERNS",
      "kind": "WARN",
      "severity": "HIGH",
      "status": "NEW",
      "title": "Potential zip-slip traversal strings present",
      "description": "Archive-related code references traversal patterns like '../' or '..\\'.",
      "risk": "If used in archive entry names or extraction logic, traversal can overwrite or create files outside the intended directory.",
      "confidenceRationale": "Traversal patterns are explicit; exact exploitability depends on the extraction implementation.",
      "recommendation": "Reject any archive entries with traversal or absolute paths and enforce extraction under a fixed, canonical directory.",
      "file": "search.ts",
      "line": 8,
      "snippet": "import * as utils from '../lib/utils'"
    },
    {
      "ruleId": "F910_ZIP_SLIP_PATTERNS",
      "kind": "WARN",
      "severity": "HIGH",
      "status": "NEW",
      "title": "Potential zip-slip traversal strings present",
      "description": "Archive-related code references traversal patterns like '../' or '..\\'.",
      "risk": "If used in archive entry names or extraction logic, traversal can overwrite or create files outside the intended directory.",
      "confidenceRationale": "Traversal patterns are explicit; exact exploitability depends on the extraction implementation.",
      "recommendation": "Reject any archive entries with traversal or absolute paths and enforce extraction under a fixed, canonical directory.",
      "file": "search.ts",
      "line": 9,
      "snippet": "import * as models from '../models/index'"
    },
    {
      "ruleId": "F910_ZIP_SLIP_PATTERNS",
      "kind": "WARN",
      "severity": "HIGH",
      "status": "NEW",
      "title": "Potential zip-slip traversal strings present",
      "description": "Archive-related code references traversal patterns like '../' or '..\\'.",
      "risk": "If used in archive entry names or extraction logic, traversal can overwrite or create files outside the intended directory.",
      "confidenceRationale": "Traversal patterns are explicit; exact exploitability depends on the extraction implementation.",
      "recommendation": "Reject any archive entries with traversal or absolute paths and enforce extraction under a fixed, canonical directory.",
      "file": "search.ts",
      "line": 10,
      "snippet": "import { UserModel } from '../models/user'"
    },
    {
      "ruleId": "F910_ZIP_SLIP_PATTERNS",
      "kind": "WARN",
      "severity": "HIGH",
      "status": "NEW",
      "title": "Potential zip-slip traversal strings present",
      "description": "Archive-related code references traversal patterns like '../' or '..\\'.",
      "risk": "If used in archive entry names or extraction logic, traversal can overwrite or create files outside the intended directory.",
      "confidenceRationale": "Traversal patterns are explicit; exact exploitability depends on the extraction implementation.",
      "recommendation": "Reject any archive entries with traversal or absolute paths and enforce extraction under a fixed, canonical directory.",
      "file": "search.ts",
      "line": 11,
      "snippet": "import { challenges } from '../data/datacache'"
    },
    {
      "ruleId": "F910_ZIP_SLIP_PATTERNS",
      "kind": "WARN",
      "severity": "HIGH",
      "status": "NEW",
      "title": "Potential zip-slip traversal strings present",
      "description": "Archive-related code references traversal patterns like '../' or '..\\'.",
      "risk": "If used in archive entry names or extraction logic, traversal can overwrite or create files outside the intended directory.",
      "confidenceRationale": "Traversal patterns are explicit; exact exploitability depends on the extraction implementation.",
      "recommendation": "Reject any archive entries with traversal or absolute paths and enforce extraction under a fixed, canonical directory.",
      "file": "search.ts",
      "line": 12,
      "snippet": "import * as challengeUtils from '../lib/challengeUtils'"
    },
    {
      "ruleId": "W127_BASE64_SECRET_LIKE",
      "kind": "WARN",
      "severity": "MEDIUM",
      "status": "NEW",
      "title": "Base64-encoded value near secret-like key",
      "description": "A base64-encoded value was assigned to a secret-like key.",
      "risk": "Base64 is often used to encode secrets, not protect them. If sensitive, this may expose credentials.",
      "confidenceRationale": "Base64 values are common and ambiguous without context.",
      "recommendation": "Confirm whether the value is sensitive. If it is, rotate it and store it securely outside source control.",
      "file": "search.ts",
      "line": 18,
      "snippet": "// vuln-code-snippet start unionSqlInjectionChallenge dbSchemaChallenge"
    },
    {
      "ruleId": "W127_BASE64_SECRET_LIKE",
      "kind": "WARN",
      "severity": "MEDIUM",
      "status": "NEW",
      "title": "Base64-encoded value near secret-like key",
      "description": "A base64-encoded value was assigned to a secret-like key.",
      "risk": "Base64 is often used to encode secrets, not protect them. If sensitive, this may expose credentials.",
      "confidenceRationale": "Base64 values are common and ambiguous without context.",
      "recommendation": "Confirm whether the value is sensitive. If it is, rotate it and store it securely outside source control.",
      "file": "search.ts",
      "line": 23,
      "snippet": "models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`) // vuln-code-snippet vuln-line unionSqlInjectionChallenge dbSchemaChallenge"
    },
    {
      "ruleId": "W127_BASE64_SECRET_LIKE",
      "kind": "WARN",
      "severity": "MEDIUM",
      "status": "NEW",
      "title": "Base64-encoded value near secret-like key",
      "description": "A base64-encoded value was assigned to a secret-like key.",
      "risk": "Base64 is often used to encode secrets, not protect them. If sensitive, this may expose credentials.",
      "confidenceRationale": "Base64 values are common and ambiguous without context.",
      "recommendation": "Confirm whether the value is sensitive. If it is, rotate it and store it securely outside source control.",
      "file": "search.ts",
      "line": 26,
      "snippet": "if (challengeUtils.notSolved(challenges.unionSqlInjectionChallenge)) { // vuln-code-snippet hide-start"
    },
    {
      "ruleId": "W127_BASE64_SECRET_LIKE",
      "kind": "WARN",
      "severity": "MEDIUM",
      "status": "NEW",
      "title": "Base64-encoded value near secret-like key",
      "description": "A base64-encoded value was assigned to a secret-like key.",
      "risk": "Base64 is often used to encode secrets, not protect them. If sensitive, this may expose credentials.",
      "confidenceRationale": "Base64 values are common and ambiguous without context.",
      "recommendation": "Confirm whether the value is sensitive. If it is, rotate it and store it securely outside source control.",
      "file": "search.ts",
      "line": 38,
      "snippet": "challengeUtils.solve(challenges.unionSqlInjectionChallenge)"
    },
    {
      "ruleId": "I309_GRAPHQL_INJECTION_RISK",
      "kind": "WARN",
      "severity": "MEDIUM",
      "status": "NEW",
      "title": "GraphQL query construction may be risky",
      "description": "A GraphQL query appears to be constructed dynamically as a string.",
      "risk": "Dynamic query construction can increase risk of injection-like issues or authorization bypass depending on server logic.",
      "confidenceRationale": "GraphQL systems vary widely; dynamic strings are not always unsafe but warrant review.",
      "recommendation": "Prefer persisted queries or structured query building. Ensure variables and authorization checks are enforced server-side.",
      "file": "search.ts",
      "line": 23,
      "snippet": "models.sequelize.query(`SELECT * FROM Products WHERE ((name LIKE '%${criteria}%' OR description LIKE '%${criteria}%') AND deletedAt IS NULL) ORDER BY name`) // vuln-code-snippet vuln-line unionSqlInjectionChallenge dbSchemaChallenge"
    },
    {
      "ruleId": "F907_DIRECTORY_TRAVERSAL_REGEX_ONLY",
      "kind": "WARN",
      "severity": "MEDIUM",
      "status": "NEW",
      "title": "Path traversal prevention may rely on regex-only sanitization",
      "description": "Code appears to attempt path traversal prevention via string replace/regex logic.",
      "risk": "Regex-only sanitization is commonly bypassed via encoding, separator tricks, and normalization edge cases.",
      "confidenceRationale": "Heuristic: true safety requires canonicalization + base-directory enforcement.",
      "recommendation": "Canonicalize paths (resolve/realpath) and enforce they remain within an expected base directory; avoid ad-hoc regex sanitization.",
      "file": "search.ts",
      "line": 8,
      "snippet": "import * as utils from '../lib/utils'"
    },
    {
      "ruleId": "F907_DIRECTORY_TRAVERSAL_REGEX_ONLY",
      "kind": "WARN",
      "severity": "MEDIUM",
      "status": "NEW",
      "title": "Path traversal prevention may rely on regex-only sanitization",
      "description": "Code appears to attempt path traversal prevention via string replace/regex logic.",
      "risk": "Regex-only sanitization is commonly bypassed via encoding, separator tricks, and normalization edge cases.",
      "confidenceRationale": "Heuristic: true safety requires canonicalization + base-directory enforcement.",
      "recommendation": "Canonicalize paths (resolve/realpath) and enforce they remain within an expected base directory; avoid ad-hoc regex sanitization.",
      "file": "search.ts",
      "line": 9,
      "snippet": "import * as models from '../models/index'"
    },
    {
      "ruleId": "F907_DIRECTORY_TRAVERSAL_REGEX_ONLY",
      "kind": "WARN",
      "severity": "MEDIUM",
      "status": "NEW",
      "title": "Path traversal prevention may rely on regex-only sanitization",
      "description": "Code appears to attempt path traversal prevention via string replace/regex logic.",
      "risk": "Regex-only sanitization is commonly bypassed via encoding, separator tricks, and normalization edge cases.",
      "confidenceRationale": "Heuristic: true safety requires canonicalization + base-directory enforcement.",
      "recommendation": "Canonicalize paths (resolve/realpath) and enforce they remain within an expected base directory; avoid ad-hoc regex sanitization.",
      "file": "search.ts",
      "line": 10,
      "snippet": "import { UserModel } from '../models/user'"
    }
  ]
}