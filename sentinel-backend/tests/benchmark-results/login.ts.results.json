{
  "meta": {
    "repo": "juice-shop",
    "relPath": "routes/login.ts",
    "lang": "typescript"
  },
  "verdict": "FAIL",
  "findingCount": 15,
  "findings": [
    {
      "ruleId": "SQL004_REQ_INPUT_IN_QUERY",
      "kind": "FAIL",
      "severity": "CRITICAL",
      "status": "NEW",
      "title": "Direct user input in SQL query",
      "description": "User-supplied input is directly interpolated or concatenated into a SQL query across JavaScript, Java, Go, C#, Ruby, or PHP.",
      "risk": "Directly including user input in SQL queries is the most common path to SQL injection — potentially leading to full database compromise.",
      "confidenceRationale": "A user-input source and query execution sink on the same line is a near-certain indicator of SQL injection.",
      "recommendation": "Use parameterized queries in every language. Pass all user values as bind parameters, never as part of the query string.",
      "file": "login.ts",
      "line": 34,
      "snippet": "models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: UserModel, plain: true }) // vuln-code-snippet vuln-line loginAdminChallenge loginBenderChallenge loginJimChallenge"
    },
    {
      "ruleId": "P1309_SCHEMA_PASSWORD_FIELD_NOT_HASH",
      "kind": "WARN",
      "severity": "CRITICAL",
      "status": "NEW",
      "title": "Schema introduces a password field that does not look hashed",
      "description": "A schema/migration appears to add a `password` column without hash/digest/encrypted naming.",
      "risk": "Storing passwords in cleartext (or reversible form) is catastrophic and creates extreme breach impact.",
      "confidenceRationale": "`password` as a stored field name (without hash/digest indicators) is a strong signal and rarely legitimate.",
      "recommendation": "Store only password hashes (strong adaptive hashing) and never store raw passwords. Review authentication storage design immediately.",
      "file": "login.ts",
      "line": 34,
      "snippet": "models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: UserModel, plain: true }) // vuln-code-snippet vuln-line loginAdminChallenge loginBenderChallenge loginJimChallenge"
    },
    {
      "ruleId": "P1309_SCHEMA_PASSWORD_FIELD_NOT_HASH",
      "kind": "WARN",
      "severity": "CRITICAL",
      "status": "NEW",
      "title": "Schema introduces a password field that does not look hashed",
      "description": "A schema/migration appears to add a `password` column without hash/digest/encrypted naming.",
      "risk": "Storing passwords in cleartext (or reversible form) is catastrophic and creates extreme breach impact.",
      "confidenceRationale": "`password` as a stored field name (without hash/digest indicators) is a strong signal and rarely legitimate.",
      "recommendation": "Store only password hashes (strong adaptive hashing) and never store raw passwords. Review authentication storage design immediately.",
      "file": "login.ts",
      "line": 60,
      "snippet": "challengeUtils.solveIf(challenges.weakPasswordChallenge, () => { return req.body.email === 'admin@' + config.get<string>('application.domain') && req.body.password === 'admin123' })"
    },
    {
      "ruleId": "P1309_SCHEMA_PASSWORD_FIELD_NOT_HASH",
      "kind": "WARN",
      "severity": "CRITICAL",
      "status": "NEW",
      "title": "Schema introduces a password field that does not look hashed",
      "description": "A schema/migration appears to add a `password` column without hash/digest/encrypted naming.",
      "risk": "Storing passwords in cleartext (or reversible form) is catastrophic and creates extreme breach impact.",
      "confidenceRationale": "`password` as a stored field name (without hash/digest indicators) is a strong signal and rarely legitimate.",
      "recommendation": "Store only password hashes (strong adaptive hashing) and never store raw passwords. Review authentication storage design immediately.",
      "file": "login.ts",
      "line": 61,
      "snippet": "challengeUtils.solveIf(challenges.loginSupportChallenge, () => { return req.body.email === 'support@' + config.get<string>('application.domain') && req.body.password === 'J6aVjTgOpRs@?5l!Zkq2AYnCE@RF$P' })"
    },
    {
      "ruleId": "P1309_SCHEMA_PASSWORD_FIELD_NOT_HASH",
      "kind": "WARN",
      "severity": "CRITICAL",
      "status": "NEW",
      "title": "Schema introduces a password field that does not look hashed",
      "description": "A schema/migration appears to add a `password` column without hash/digest/encrypted naming.",
      "risk": "Storing passwords in cleartext (or reversible form) is catastrophic and creates extreme breach impact.",
      "confidenceRationale": "`password` as a stored field name (without hash/digest indicators) is a strong signal and rarely legitimate.",
      "recommendation": "Store only password hashes (strong adaptive hashing) and never store raw passwords. Review authentication storage design immediately.",
      "file": "login.ts",
      "line": 62,
      "snippet": "challengeUtils.solveIf(challenges.loginRapperChallenge, () => { return req.body.email === 'mc.safesearch@' + config.get<string>('application.domain') && req.body.password === 'Mr. N00dles' })"
    },
    {
      "ruleId": "P1309_SCHEMA_PASSWORD_FIELD_NOT_HASH",
      "kind": "WARN",
      "severity": "CRITICAL",
      "status": "NEW",
      "title": "Schema introduces a password field that does not look hashed",
      "description": "A schema/migration appears to add a `password` column without hash/digest/encrypted naming.",
      "risk": "Storing passwords in cleartext (or reversible form) is catastrophic and creates extreme breach impact.",
      "confidenceRationale": "`password` as a stored field name (without hash/digest indicators) is a strong signal and rarely legitimate.",
      "recommendation": "Store only password hashes (strong adaptive hashing) and never store raw passwords. Review authentication storage design immediately.",
      "file": "login.ts",
      "line": 63,
      "snippet": "challengeUtils.solveIf(challenges.loginAmyChallenge, () => { return req.body.email === 'amy@' + config.get<string>('application.domain') && req.body.password === 'K1f.....................' })"
    },
    {
      "ruleId": "P1309_SCHEMA_PASSWORD_FIELD_NOT_HASH",
      "kind": "WARN",
      "severity": "CRITICAL",
      "status": "NEW",
      "title": "Schema introduces a password field that does not look hashed",
      "description": "A schema/migration appears to add a `password` column without hash/digest/encrypted naming.",
      "risk": "Storing passwords in cleartext (or reversible form) is catastrophic and creates extreme breach impact.",
      "confidenceRationale": "`password` as a stored field name (without hash/digest indicators) is a strong signal and rarely legitimate.",
      "recommendation": "Store only password hashes (strong adaptive hashing) and never store raw passwords. Review authentication storage design immediately.",
      "file": "login.ts",
      "line": 64,
      "snippet": "challengeUtils.solveIf(challenges.dlpPasswordSprayingChallenge, () => { return req.body.email === 'J12934@' + config.get<string>('application.domain') && req.body.password === '0Y8rMnww$*9VFYE§59-!Fg1L6t&6lB' })"
    },
    {
      "ruleId": "P1309_SCHEMA_PASSWORD_FIELD_NOT_HASH",
      "kind": "WARN",
      "severity": "CRITICAL",
      "status": "NEW",
      "title": "Schema introduces a password field that does not look hashed",
      "description": "A schema/migration appears to add a `password` column without hash/digest/encrypted naming.",
      "risk": "Storing passwords in cleartext (or reversible form) is catastrophic and creates extreme breach impact.",
      "confidenceRationale": "`password` as a stored field name (without hash/digest indicators) is a strong signal and rarely legitimate.",
      "recommendation": "Store only password hashes (strong adaptive hashing) and never store raw passwords. Review authentication storage design immediately.",
      "file": "login.ts",
      "line": 65,
      "snippet": "challengeUtils.solveIf(challenges.oauthUserPasswordChallenge, () => { return req.body.email === 'bjoern.kimminich@gmail.com' && req.body.password === 'bW9jLmxpYW1nQGhjaW5pbW1pay5ucmVvamI=' })"
    },
    {
      "ruleId": "P1309_SCHEMA_PASSWORD_FIELD_NOT_HASH",
      "kind": "WARN",
      "severity": "CRITICAL",
      "status": "NEW",
      "title": "Schema introduces a password field that does not look hashed",
      "description": "A schema/migration appears to add a `password` column without hash/digest/encrypted naming.",
      "risk": "Storing passwords in cleartext (or reversible form) is catastrophic and creates extreme breach impact.",
      "confidenceRationale": "`password` as a stored field name (without hash/digest indicators) is a strong signal and rarely legitimate.",
      "recommendation": "Store only password hashes (strong adaptive hashing) and never store raw passwords. Review authentication storage design immediately.",
      "file": "login.ts",
      "line": 66,
      "snippet": "challengeUtils.solveIf(challenges.exposedCredentialsChallenge, () => { return req.body.email === 'testing@' + config.get<string>('application.domain') && req.body.password === 'IamUsedForTesting' })"
    },
    {
      "ruleId": "FS001_POSSIBLE_SECRET_ASSIGN",
      "kind": "FAIL",
      "severity": "HIGH",
      "status": "NEW",
      "title": "Possible secret committed",
      "description": "A high-entropy value was added near a secret-like variable or configuration key.",
      "risk": "Real credentials in source control allow unauthorized access.",
      "confidenceRationale": "High-entropy values near secret keywords are high-confidence indicators of leakage.",
      "recommendation": "Rotate the credential and move it to a secret manager.",
      "file": "login.ts",
      "line": 65,
      "snippet": "challengeUtils.solveIf(challenges.oauthUserPasswordChallenge, () => { return req.body.email === 'bjoern.kimminich@gmail.com' && req.body.password === 'bW9jLmxpYW1nQGhjaW5pbW1pay5ucmVvamI=' })"
    },
    {
      "ruleId": "FS001_POSSIBLE_SECRET_ASSIGN",
      "kind": "FAIL",
      "severity": "HIGH",
      "status": "NEW",
      "title": "Possible secret committed",
      "description": "A high-entropy value was added near a secret-like variable or configuration key.",
      "risk": "Real credentials in source control allow unauthorized access.",
      "confidenceRationale": "High-entropy values near secret keywords are high-confidence indicators of leakage.",
      "recommendation": "Rotate the credential and move it to a secret manager.",
      "file": "login.ts",
      "line": 66,
      "snippet": "challengeUtils.solveIf(challenges.exposedCredentialsChallenge, () => { return req.body.email === 'testing@' + config.get<string>('application.domain') && req.body.password === 'IamUsedForTesting' })"
    },
    {
      "ruleId": "W101_POSSIBLE_SECRET_VAR_ASSIGN",
      "kind": "WARN",
      "severity": "HIGH",
      "status": "NEW",
      "title": "Possible secret committed",
      "description": "A high-entropy value was added near a secret-like variable or configuration key.",
      "risk": "If this value is a real credential, it could enable unauthorized access to systems, data, or third-party services.",
      "confidenceRationale": "The value appears random and is associated with a secret-like name, but it does not match a stable vendor credential format.",
      "recommendation": "Confirm whether the value is a credential. If it is, revoke/rotate it and load it from a secret manager or environment variable.",
      "file": "login.ts",
      "line": 65,
      "snippet": "challengeUtils.solveIf(challenges.oauthUserPasswordChallenge, () => { return req.body.email === 'bjoern.kimminich@gmail.com' && req.body.password === 'bW9jLmxpYW1nQGhjaW5pbW1pay5ucmVvamI=' })"
    },
    {
      "ruleId": "W101_POSSIBLE_SECRET_VAR_ASSIGN",
      "kind": "WARN",
      "severity": "HIGH",
      "status": "NEW",
      "title": "Possible secret committed",
      "description": "A high-entropy value was added near a secret-like variable or configuration key.",
      "risk": "If this value is a real credential, it could enable unauthorized access to systems, data, or third-party services.",
      "confidenceRationale": "The value appears random and is associated with a secret-like name, but it does not match a stable vendor credential format.",
      "recommendation": "Confirm whether the value is a credential. If it is, revoke/rotate it and load it from a secret manager or environment variable.",
      "file": "login.ts",
      "line": 66,
      "snippet": "challengeUtils.solveIf(challenges.exposedCredentialsChallenge, () => { return req.body.email === 'testing@' + config.get<string>('application.domain') && req.body.password === 'IamUsedForTesting' })"
    },
    {
      "ruleId": "W117_SMTP_CREDENTIALS",
      "kind": "WARN",
      "severity": "HIGH",
      "status": "NEW",
      "title": "Possible SMTP credentials committed",
      "description": "SMTP connection credentials were added to the codebase.",
      "risk": "SMTP credentials can be abused to send spam or phishing emails.",
      "confidenceRationale": "SMTP configs often include usernames and passwords but may be placeholders depending on environment.",
      "recommendation": "Move SMTP credentials to a secret manager and rotate them if they are real.",
      "file": "login.ts",
      "line": 26,
      "snippet": "res.json({ authentication: { token, bid: basket.id, umail: user.data.email } })"
    },
    {
      "ruleId": "W117_SMTP_CREDENTIALS",
      "kind": "WARN",
      "severity": "HIGH",
      "status": "NEW",
      "title": "Possible SMTP credentials committed",
      "description": "SMTP connection credentials were added to the codebase.",
      "risk": "SMTP credentials can be abused to send spam or phishing emails.",
      "confidenceRationale": "SMTP configs often include usernames and passwords but may be placeholders depending on environment.",
      "recommendation": "Move SMTP credentials to a secret manager and rotate them if they are real.",
      "file": "login.ts",
      "line": 34,
      "snippet": "models.sequelize.query(`SELECT * FROM Users WHERE email = '${req.body.email || ''}' AND password = '${security.hash(req.body.password || '')}' AND deletedAt IS NULL`, { model: UserModel, plain: true }) // vuln-code-snippet vuln-line loginAdminChallenge loginBenderChallenge loginJimChallenge"
    }
  ]
}