{
  "meta": {
    "repo": "BenchmarkingPython",
    "relPath": "testcode/BenchmarkTest00007.py",
    "lang": "python"
  },
  "verdict": "WARN",
  "findingCount": 9,
  "findings": [
    {
      "ruleId": "F910_ZIP_SLIP_PATTERNS",
      "kind": "WARN",
      "severity": "HIGH",
      "status": "NEW",
      "title": "Potential zip-slip traversal strings present",
      "description": "Archive-related code references traversal patterns like '../' or '..\\'.",
      "risk": "If used in archive entry names or extraction logic, traversal can overwrite or create files outside the intended directory.",
      "confidenceRationale": "Traversal patterns are explicit; exact exploitability depends on the extraction implementation.",
      "recommendation": "Reject any archive entries with traversal or absolute paths and enforce extraction under a fixed, canonical directory.",
      "file": "BenchmarkTest00007.py",
      "line": 48,
      "snippet": "if '../' in bar:"
    },
    {
      "ruleId": "F910_ZIP_SLIP_PATTERNS",
      "kind": "WARN",
      "severity": "HIGH",
      "status": "NEW",
      "title": "Potential zip-slip traversal strings present",
      "description": "Archive-related code references traversal patterns like '../' or '..\\'.",
      "risk": "If used in archive entry names or extraction logic, traversal can overwrite or create files outside the intended directory.",
      "confidenceRationale": "Traversal patterns are explicit; exact exploitability depends on the extraction implementation.",
      "recommendation": "Reject any archive entries with traversal or absolute paths and enforce extraction under a fixed, canonical directory.",
      "file": "BenchmarkTest00007.py",
      "line": 50,
      "snippet": "'File name must not contain \\'../\\''"
    },
    {
      "ruleId": "F907_DIRECTORY_TRAVERSAL_REGEX_ONLY",
      "kind": "WARN",
      "severity": "MEDIUM",
      "status": "NEW",
      "title": "Path traversal prevention may rely on regex-only sanitization",
      "description": "Code appears to attempt path traversal prevention via string replace/regex logic.",
      "risk": "Regex-only sanitization is commonly bypassed via encoding, separator tricks, and normalization edge cases.",
      "confidenceRationale": "Heuristic: true safety requires canonicalization + base-directory enforcement.",
      "recommendation": "Canonicalize paths (resolve/realpath) and enforce they remain within an expected base directory; avoid ad-hoc regex sanitization.",
      "file": "BenchmarkTest00007.py",
      "line": 48,
      "snippet": "if '../' in bar:"
    },
    {
      "ruleId": "F907_DIRECTORY_TRAVERSAL_REGEX_ONLY",
      "kind": "WARN",
      "severity": "MEDIUM",
      "status": "NEW",
      "title": "Path traversal prevention may rely on regex-only sanitization",
      "description": "Code appears to attempt path traversal prevention via string replace/regex logic.",
      "risk": "Regex-only sanitization is commonly bypassed via encoding, separator tricks, and normalization edge cases.",
      "confidenceRationale": "Heuristic: true safety requires canonicalization + base-directory enforcement.",
      "recommendation": "Canonicalize paths (resolve/realpath) and enforce they remain within an expected base directory; avoid ad-hoc regex sanitization.",
      "file": "BenchmarkTest00007.py",
      "line": 50,
      "snippet": "'File name must not contain \\'../\\''"
    },
    {
      "ruleId": "F913_FILENAME_NOT_SANITIZED",
      "kind": "WARN",
      "severity": "MEDIUM",
      "status": "NEW",
      "title": "Filename used without obvious sanitization",
      "description": "Upload filename appears used without obvious normalization/sanitization nearby.",
      "risk": "Unsanitized filenames can include traversal sequences, unicode tricks, or dangerous extensions.",
      "confidenceRationale": "Heuristic: sanitization may exist in shared helpers; still worth review.",
      "recommendation": "Normalize filenames, strip path separators, enforce allowlisted extensions, and generate server-side storage names.",
      "file": "BenchmarkTest00007.py",
      "line": 26,
      "snippet": "response.set_cookie('BenchmarkTest00007', 'FileName',"
    },
    {
      "ruleId": "F913_FILENAME_NOT_SANITIZED",
      "kind": "WARN",
      "severity": "MEDIUM",
      "status": "NEW",
      "title": "Filename used without obvious sanitization",
      "description": "Upload filename appears used without obvious normalization/sanitization nearby.",
      "risk": "Unsanitized filenames can include traversal sequences, unicode tricks, or dangerous extensions.",
      "confidenceRationale": "Heuristic: sanitization may exist in shared helpers; still worth review.",
      "recommendation": "Normalize filenames, strip path separators, enforce allowlisted extensions, and generate server-side storage names.",
      "file": "BenchmarkTest00007.py",
      "line": 55,
      "snippet": "fileName = f'{helpers.utils.TESTFILES_DIR}/{bar}'"
    },
    {
      "ruleId": "F913_FILENAME_NOT_SANITIZED",
      "kind": "WARN",
      "severity": "MEDIUM",
      "status": "NEW",
      "title": "Filename used without obvious sanitization",
      "description": "Upload filename appears used without obvious normalization/sanitization nearby.",
      "risk": "Unsanitized filenames can include traversal sequences, unicode tricks, or dangerous extensions.",
      "confidenceRationale": "Heuristic: sanitization may exist in shared helpers; still worth review.",
      "recommendation": "Normalize filenames, strip path separators, enforce allowlisted extensions, and generate server-side storage names.",
      "file": "BenchmarkTest00007.py",
      "line": 56,
      "snippet": "fd = open(fileName, 'wb')"
    },
    {
      "ruleId": "F913_FILENAME_NOT_SANITIZED",
      "kind": "WARN",
      "severity": "MEDIUM",
      "status": "NEW",
      "title": "Filename used without obvious sanitization",
      "description": "Upload filename appears used without obvious normalization/sanitization nearby.",
      "risk": "Unsanitized filenames can include traversal sequences, unicode tricks, or dangerous extensions.",
      "confidenceRationale": "Heuristic: sanitization may exist in shared helpers; still worth review.",
      "recommendation": "Normalize filenames, strip path separators, enforce allowlisted extensions, and generate server-side storage names.",
      "file": "BenchmarkTest00007.py",
      "line": 58,
      "snippet": "f'Now ready to write to file: {escape_for_html(fileName)}'"
    },
    {
      "ruleId": "F913_FILENAME_NOT_SANITIZED",
      "kind": "WARN",
      "severity": "MEDIUM",
      "status": "NEW",
      "title": "Filename used without obvious sanitization",
      "description": "Upload filename appears used without obvious normalization/sanitization nearby.",
      "risk": "Unsanitized filenames can include traversal sequences, unicode tricks, or dangerous extensions.",
      "confidenceRationale": "Heuristic: sanitization may exist in shared helpers; still worth review.",
      "recommendation": "Normalize filenames, strip path separators, enforce allowlisted extensions, and generate server-side storage names.",
      "file": "BenchmarkTest00007.py",
      "line": 62,
      "snippet": "f'Problem reading from file \\'{escape_for_html(fileName)}\\': '"
    }
  ]
}